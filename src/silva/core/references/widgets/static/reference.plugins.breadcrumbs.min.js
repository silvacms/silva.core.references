(function(infrae,$,jsontemplate){var template=new jsontemplate.Template('<span class="path-outer"><span class="path-inner">{.section link}<a href="{url|html-attr-value}" title="{id|html-attr-value}">{short_title|html}</a>{.end}{.section last}<span class="last">{short_title|html}</span>{.end}</span>{.section separator}<span class="separator">&rsaquo;</span>{.end}</span>'),max_items=3;$.extend(infrae.smi.reference.plugins,{Breadcrumbs:function($popup,manager){var $breadcrumb=$popup.find(".path-list");$breadcrumb.delegate("a","click",function(event){return manager.open($(event.target).attr("href")),!1}),manager.onchange.add(function(url){$.ajax({url:url+"/++rest++silva.core.references.parents",dataType:"json"}).done(function(parents){var len=parents.length,position=1,parts=[],build=function(info,last){return template.expand({separator:!last,last:last&&info,link:!last&&info})};for(parts.push(build(parents[0],1==len)),0!=max_items&&len>max_items+1&&(position=len-max_items,parts.push('<span class="path-outer"><span class="path-inner"><span class="path-fake">...</span></span><span class="separator">&rsaquo;</span></span>'));len>position;position++)parts.push(build(parents[position],position+1==len));$breadcrumb.html(parts.join(""))})})}})})(infrae,jQuery,jsontemplate);