(function(e,t,n){t.extend(e.smi.reference,{Adder:function(n,r,i,s){var o=t('<div class="content-list" />'),u=null,a=null,f=null;return{open:function(t){a=t+"/++rest++silva.core.references.adding/"+s;var n=function(t){return o.html(t.screen.forms),u=o.children("form"),u.attr("data-form-url",a),f!==null?(u.bind("submit",f),u.trigger("load-smiform",{form:u,container:u}),{}):(f=function(){var t=u.serializeArray();return t.push({name:u.attr("name")+".action.save",value:"Save"}),i.ajax.query(a,t).pipe(function(t){e.interfaces.is_implemented_by("redirect",t)?r.back():n(t)}),!1},u.bind("submit",f),{insert:function(e){return o!==e&&(o.hide(),o.insertAfter(e),e.slideUp(),o.slideDown()),u.trigger("load-smiform",{form:u,container:u}),o},$content:o,actions:{Back:r.back,Add:f}})};return i.ajax.query(a).pipe(n)},update:function(e){s=e}}}})})(infrae,jQuery,jsontemplate);