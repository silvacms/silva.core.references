(function(infrae,$){$.extend(infrae.smi.reference.plugins,{AddMenu:function($popup,manager){var $action=$popup.find(".content-actions"),$trigger=$action.find("a"),$select=$action.find("select"),empty=$select.html(),opened_url=null,open=function(){var selected=$select.val();return selected&&opened_url&&manager.add(opened_url,selected),!1};$trigger.bind("click",open),$select.bind("change",open),manager.onchange.add(function(url){var options={url:url+"/++rest++silva.core.references.adding",dataType:"json"};void 0!==manager.configuration.iface&&(options.data={"interface":manager.configuration.iface}),$.ajax(options).done(function(addables){var options=[empty];$action.toggle(0!==addables.length);for(var i=0,len=addables.length;len>i;i++)options.push('<option value="'+addables[i]+'">'+addables[i]+"</option>");opened_url=url,$select.html(options.join(""))})})}})})(infrae,jQuery,jsontemplate);